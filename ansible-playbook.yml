- name : Configure Docker on EC2 Instances
  hosts : all
  become: true
  connection : ssh
  tasks : 
  - name: updating apt
    command : sudo apt-get update

  - name: Deploy Docker image to Kubernetes
    k8s:
      state: present
      definition:
        apiVersion: apps/v1
        kind: Deployment
        metadata:
          name: health
        spec:
          replicas: 1
          selector:
            matchLabels:
              app: health
          template:
            metadata:
              labels:
                app: health
            spec:
              containers:
              - name: healthcare-container
                image: rishi0803/healthcare-project
                ports:
                - containerPort: 8082

